from pydantic import BaseModel, Field,  HttpUrl
from typing import List, Optional,Literal

class EditorAgentInput(BaseModel):
    question: str = Field(..., description="The original user question")
    previous_answer: str = Field(..., description="The answer that needs to be reviewed or edited")
    score: Optional[float] = Field(None, description="The factual accuracy score of the previous answer")
    reasoning: Optional[str] = Field("", description="The reasoning or explanation behind the score")
    contexts: List[str] = Field(..., description="List of contextual strings retrieved from source documents")

class EditorAgentOutput(BaseModel):
    answer: str = Field(..., description="The revised answer generated by the EditorAgent")
    error: Optional[str] = Field(None, description="Error message if an exception occurred during processing")


class EvalAgentInput(BaseModel):
    question: str = Field(..., description="The question asked to the model")
    answer: str = Field(..., description="The answer provided by the model that needs to be evaluated")
    contexts:  List[str] = Field(..., description="List of lists of contextual strings used to support the answer")

class FactEvaluation(BaseModel):
    fact: str = Field(..., description="Individual fact extracted from the answer")
    label: Literal["yes", "no", "unclear"] = Field(..., description="Judgment on the factuality of the fact")
    reasoning: str = Field(..., description="Justification for the assigned label")


class EvalAgentOutput(BaseModel):
    score: float = Field(..., description="Final score computed as ratio of 'yes' labels to total facts")
    reasoning: str = Field(..., description="Combined evaluation report including fact labels and explanations")
    error: Optional[str] = Field(None, description="Error message if evaluation failed")


class KBMetadata(BaseModel):
    title: Optional[str]
    source: Optional[str]
    page: Optional[int]
    document_title: Optional[str] = None  

class KBResponse(BaseModel):
    answer: str
    sources: List[str]
    metadata: List[KBMetadata]
    error: Optional[str]



class WebSearchMetadata(BaseModel):
    title: Optional[str]
    url: Optional[HttpUrl]
    description: Optional[str]

class WebSearchResponse(BaseModel):
    answer: str
    sources: List[str]
    metadata: List[WebSearchMetadata]
    error: Optional[str]